<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>第二十五到二十七天：倒数开始 滴答滴 滴答滴</title>
</head>
<body>
	<p id="time"></p>
	<p id="te"></p>
	<select id="year-select">
	    <option value="2000">2000</option>
	    <option value="2001">2001</option>
	    <option value="2002">2002</option>
	    <option value="2003">2003</option>
	    <option value="2004">2004</option>
	    <option value="2005">2005</option>
	    <option value="2006">2006</option>
	    <option value="2007">2007</option>
	    <option value="2008">2008</option>
	    <option value="2009">2009</option>
	    <option value="2010">2010</option>
	    <option value="2011">2011</option>
	    <option value="2012">2012</option>
	    <option value="2013">2013</option>
	    <option value="2014">2014</option>
	    <option value="2015">2015</option>
	    <option value="2016">2016</option>
	    <option value="2017">2017</option>
	    <option value="2018">2018</option>
	    <option value="2019">2019</option>
	    <option value="2020">2020</option>
	    <option value="2021">2021</option>
	    <option value="2022">2022</option>
		<option value="2023">2023</option>
		<option value="2024">2024</option>
		<option value="2025">2025</option>
		<option value="2026">2026</option>
	</select>

	<select id="month-select">
	    <option value="1">1</option>
	    <option value="2">2</option>
	   <option value="3">3</option>
	   <option value="4">4</option>
	   <option value="5">5</option>
	   <option value="6">6</option>
	   <option value="7">7</option>
	   <option value="8">8</option>
	   <option value="9">9</option>
	   <option value="10">10</option>
	   <option value="11">11</option>
	    <option value="12">12</option>
	</select>

	<select id="day-select">
	    <option value="1">1</option>
	    <option value="2">2</option>
	    <option value="3">3</option>
	    <option value="4">4</option>
	    <option value="5">5</option>
	    <option value="6">6</option>
	   <option value="7">7</option>
	   <option value="8">8</option>
	   <option value="9">9</option>
	   <option value="10">10</option>
	   <option value="11">11</option>
	   <option value="12">12</option>
	   <option value="13">13</option>
	   <option value="14">14</option>
	   <option value="15">15</option>
	   <option value="16">16</option>
	   <option value="17">17</option>
	   <option value="18">18</option>
	   <option value="19">19</option>
	   <option value="20">20</option>
	   <option value="21">21</option>
	   <option value="22">22</option>
	   <option value="23">23</option>
	   <option value="24">24</option>
	   <option value="25">25</option>
	   <option value="26">26</option>
	   <option value="27">27</option>
	   <option value="28">28</option>
	   <option value="29">29</option>
	   <option value="30">30</option>
	    <option value="31">31</option>
	</select>

	<select id="hour-select">
	    <option value="0">00</option>
	    <option value="1">01</option>        
	    <option value="2">02</option>
	    <option value="3">03</option>
	    <option value="4">04</option>
	    <option value="5">05</option>
	    <option value="6">06</option>
	    <option value="7">07</option>
	    <option value="8">08</option>
	    <option value="9">09</option>
	    <option value="10">10</option>
	    <option value="11">11</option>
	    <option value="12">12</option>
	    <option value="13">13</option>
	    <option value="14">14</option>
	    <option value="15">15</option>
	    <option value="16">16</option>
	    <option value="17">17</option>
	    <option value="8">18</option>
	    <option value="19">19</option>
	    <option value="20">20</option>
	    <option value="21">21</option>
	    <option value="23">23</option>
	</select>

	<select id="minite-select">
	    <option value="0">0</option>
	    <option value="1">1</option>
	    <option value="2">2</option>
	    <option value="3">3</option>
	    <option value="4">4</option>
	    <option value="5">5</option>
	    <option value="6">6</option>
	   <option value="7">7</option>
	   <option value="8">8</option>
	   <option value="9">9</option>
	   <option value="10">10</option>
	   <option value="11">11</option>
	   <option value="12">12</option>
	   <option value="13">13</option>
	   <option value="14">14</option>
	   <option value="15">15</option>
	   <option value="16">16</option>
	   <option value="17">17</option>
	   <option value="18">18</option>
	   <option value="19">19</option>
	   <option value="20">20</option>
	   <option value="21">21</option>
	   <option value="22">22</option>
	   <option value="23">23</option>
	   <option value="24">24</option>
	   <option value="25">25</option>
	   <option value="26">26</option>
	   <option value="27">27</option>
	   <option value="28">28</option>
	   <option value="29">29</option>
	   <option value="30">30</option>
	    <option value="31">31</option>
	    <option value="32">32</option>
	    <option value="33">33</option>
	    <option value="34">34</option>
	    <option value="35">35</option>
	    <option value="36">36</option>
	    <option value="37">37</option>
	    <option value="38">38</option>
	    <option value="39">39</option>
	    <option value="40">40</option>
	    <option value="41">41</option>
	    <option value="42">42</option>
	    <option value="43">43</option>
	    <option value="44">44</option>
	    <option value="45">45</option>
	    <option value="46">46</option>
	    <option value="47">47</option>
	    <option value="48">48</option>
	    <option value="49">49</option>
	    <option value="50">50</option>
	    <option value="51">51</option>
	    <option value="52">52</option>
	    <option value="53">53</option>
	    <option value="54">54</option>
	    <option value="55">55</option>
	    <option value="56">56</option>
	    <option value="57">57</option>
	    <option value="58">58</option>
	    <option value="59">59</option>
	</select>

	<select id="second-select">
	   <option value="0">0</option>
	    <option value="1">1</option>
	    <option value="2">2</option>
	    <option value="3">3</option>
	    <option value="4">4</option>
	    <option value="5">5</option>
	    <option value="6">6</option>
	   <option value="7">7</option>
	   <option value="8">8</option>
	   <option value="9">9</option>
	   <option value="10">10</option>
	   <option value="11">11</option>
	   <option value="12">12</option>
	   <option value="13">13</option>
	   <option value="14">14</option>
	   <option value="15">15</option>
	   <option value="16">16</option>
	   <option value="17">17</option>
	   <option value="18">18</option>
	   <option value="19">19</option>
	   <option value="20">20</option>
	   <option value="21">21</option>
	   <option value="22">22</option>
	   <option value="23">23</option>
	   <option value="24">24</option>
	   <option value="25">25</option>
	   <option value="26">26</option>
	   <option value="27">27</option>
	   <option value="28">28</option>
	   <option value="29">29</option>
	   <option value="30">30</option>
	    <option value="31">31</option>
	    <option value="32">32</option>
	    <option value="33">33</option>
	    <option value="34">34</option>
	    <option value="35">35</option>
	    <option value="36">36</option>
	    <option value="37">37</option>
	    <option value="38">38</option>
	    <option value="39">39</option>
	    <option value="40">40</option>
	    <option value="41">41</option>
	    <option value="42">42</option>
	    <option value="43">43</option>
	    <option value="44">44</option>
	    <option value="45">45</option>
	    <option value="46">46</option>
	    <option value="47">47</option>
	    <option value="48">48</option>
	    <option value="49">49</option>
	    <option value="50">50</option>
	    <option value="51">51</option>
	    <option value="52">52</option>
	    <option value="53">53</option>
	    <option value="54">54</option>
	    <option value="55">55</option>
	    <option value="56">56</option>
	    <option value="57">57</option>
	    <option value="58">58</option>
	    <option value="59">59</option>
	</select>

	<p id="result-wrapper">现在距离 2001年1月1日星期X HH:MM:SS 还有 X 天 X 小时 X 分 X 秒</p>
	<script>
		function Go() {
		    console.log("Go");
		}

		function GoSteps(n) {
			if (n == '') {
				n = 1;
			}
		   	if (isNaN(n) == true) {
		   		n = 0;
		   	}
		   	if (n < 0) {
		   		n = 0;
		   	}
		   	n = parseInt(n);
		   	while (n--) {
		   		Go();
		   	}
		}

		GoSteps(10); // Go 10次
		GoSteps(1); // Go 1次
		GoSteps(); // Go 1次，认为缺少参数时，默认参数为1
		GoSteps(0);  // 0次
		GoSteps(-1);  // 0次
		GoSteps(1.4);  // Go 1次
		GoSteps(1.6);  // Go 1次
		GoSteps(-1);  // 0次
		GoSteps(true);  // Go 1次
		GoSteps(false);  // 0次
		GoSteps("Test");  // 0次
		GoSteps(NaN);  // 0次
		GoSteps(null);  // 0次


		var t = setInterval(getTime, 1000),
			content = document.getElementById('time'),
			ct = document.getElementById('te'),
			m =setInterval(getTimes, 1000);
		function getTime() {
			var year = new Date(),
				month = new Date(),
				day = new Date(),
				week = new Date(),
				hour = new Date(),
				minute = new Date(),
				seconds = new Date();
			year = year.getFullYear();
			month = month.getMonth();
			day = day.getDate();
			week = week.getDay();
			hour = hour.getHours();
			minute = minute.getMinutes();
			seconds = seconds.getSeconds();

			week = changeWeek(week);
			month = addone(month);
			month = addzero(month);
			day = addzero(day);
			hour = addzero(hour);
			minute = addzero(minute);
			seconds = addzero(seconds);
			content.innerHTML = year + '年' + month + '月' + day + '日' + '星期' + week + hour + ':' + minute + ':' +seconds;
		}
		function getTimes() {
			var s = '',
				year = new Date(),
				month = new Date(),
				day = new Date(),
				week = new Date(),
				hour = new Date(),
				minute = new Date(),
				seconds = new Date();
			year = year.getFullYear();
			month = month.getMonth();
			day = day.getDate();
			week = week.getDay();
			hour = hour.getHours();
			minute = minute.getMinutes();
			seconds = seconds.getSeconds();

			week = changeWeekEnglish(week);
			month = addone(month);
			month = addzero(month);
			day = addzero(day);
			hour = addzero(hour);
			minute = addzero(minute);
			seconds = addzero(seconds);

			if (hour >= 0 && hour <= 12 ) {
				s = 'AM';
			}else {
				s = 'PM';
			}
			ct.innerHTML = year + '-' + month + '-' + day + week + hour + ':' + minute + ':' +seconds + s;
		}
		function addone(m) {
			return m + 1;
		}
		function addzero(h) {
			if(h < 10) {
				h = h.toString();
				h = '0' + h; 
			}
			return h;
		}
		function changeWeek(day) {
			var arr = ['日','一','二','三','四','五','六'];
			return arr[day];
		}
		function changeWeekEnglish(day) {
			var arr = ['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];
			return arr[day];
		}

		//
		document.getElementById('month-select').addEventListener('change', function(e) {
			console.log(e.target.value);
			var arr = document.getElementById('day-select').querySelectorAll('option');
			if (e.target.value == 4 || e.target.value == 6 ||e.target.value == 9 || e.target.value == 11) {
				show(arr[28]);
				show(arr[29]);
				if (arr[30].value == 31) {
					hidden(arr[30]);
				}

				//如果此时刚好是31时，需要改变这个值
				if (document.getElementById('day-select').value == 31) {
					document.getElementById('day-select').value = 1;
				}
			}else if (e.target.value == 2) {
				if (!leapYear(document.getElementById('year-select').value)) {
					hidden(arr[28]);
					if (document.getElementById('day-select').value == 29) {
						document.getElementById('day-select').value = 1;
					}
				}
				hidden(arr[30]);
				hidden(arr[29]);
				if (document.getElementById('day-select').value == 30 || document.getElementById('day-select').value ==31) {
						document.getElementById('day-select').value = 1;
					}
			}else {
				show(arr[28]);
				show(arr[29]);
				show(arr[30]);

			}
		}, false);
		document.getElementById('year-select').addEventListener('change', function(e) {
			var arr = document.getElementById('day-select').querySelectorAll('option');
 			if (leapYear(e.target.value)) {
 				if (document.getElementById('month-select').value == 2) {
 					show(arr[28]);
 				}
 				
 			}else {//不是闰年
 				if (document.getElementById('month-select').value == 2) {
 					hidden(arr[28]);
 				}
 				if (document.getElementById('day-select').value == 29) {
					document.getElementById('day-select').value = 1;
				}
 			}
		}, false)

		document.body.addEventListener('change', function(e) {
			if (e.target.nodeName.toUpperCase() == 'SELECT') {
				calculate(document.getElementById('year-select').value,document.getElementById('month-select').value,document.getElementById('day-select').value,document.getElementById('hour-select').value,document.getElementById('minite-select').value,document.getElementById('second-select').value);
			}
		}, false)
		//使得相关日期失效
		function hidden(option) {
			option.disabled = 'true';
		}
		//将日期变得可以使用
		function show(option) {
			option.removeAttribute('disabled');
		}
		//判断闰年
		function leapYear(year) {
			if (year % 4 == 0 && year % 100 != 0 || year % 400 == 0 ) {
				return true;// 是闰年
			}else {
				return false;
			}
		}
		function calculate(year,month,day,hour,minute,seconds) {
			var week = new Date(year,month - 1,day);
			// console.log(week.getDay());
			week = week.getDay();
			week = changeWeek(week);
			var nowDate = new Date(),
				tDate = new Date(year,month-1,day,hour,minute,seconds),
				cha = nowDate.getTime() - tDate.getTime(),
				flag;//表示这个时间在现在时间的前面还是后面
			if (cha < 0) {
				flag = -1;
			}else if (cha == 0) {
				flag = 0;
			}else {
				flag = 1;
			}
			cha = Math.abs(cha);

			var d = parseInt(cha / (1000 *60 *60 *24)),
				h = parseInt((cha - d * 1000 * 60 * 60 * 24) / (1000 * 60 *60)),
				m = parseInt((cha - d * 1000 * 60 * 60 * 24 - h * 1000 * 60 * 60) / (1000 * 60)),
				s = parseInt((cha - d * 1000 * 60 * 60 * 24 - h * 1000 * 60 * 60 - m * 1000 * 60) / 1000);
			// return [flag,d,h,m,s,week];
			if (flag == -1) {
				document.getElementById('result-wrapper').innerHTML = '现在距离' + year + '年' + month + '月' + day +'日 星期' + week + hour + ':' + minute + ':' + seconds + '还有' + d + '天' + h + '小时'  + m + '分' + s + '秒';
			}else if (flag == 1) {
				document.getElementById('result-wrapper').innerHTML = '现在距离' + year + '年' + month + '月' + day +'日 星期' + week + hour + ':' + minute + ':' + seconds + '已经过去' + d + '天' + h + '小时'  + m + '分' + s + '秒';
			}else {
				document.getElementById('result-wrapper').innerHTML = '正好，哈哈哈';
			}
			
		}

	</script>
</body>
</html>